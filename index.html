<html>
  <head>
  </head>
  <body>
    <p>Tuna</p>
    <script src="tuna.js"></script>
    <button onclick="playSong()">Play</button>
    <button onclick="stopSong()">Stop</button>

    <script>

    var c = new AudioContext();
    var tuna = new Tuna(c);
    var effect = new tuna.MoogFilter();
    var songBuffer, songSource;
    loadSong();

      function loadSong() {
        var xhr = new XMLHttpRequest();
        xhr.open("get", "drums.wav", true);
        xhr.responseType = "arraybuffer";
        xhr.onload = function(result){
          console.log(result.target.response, c);
          c.decodeAudioData(result.target.response, function(buffer){
            songBuffer = buffer;
          });
        }
        xhr.send(null);
      }

      function playSong() {
        songSource = c.createBufferSource();
        songSource.buffer = songBuffer;
        songSource.loop = true;
        songSource.connect(effect.input);
        effect.connect(c.destination);
        songSource.start(c.currentTime);
      }

       function stopSong() {
           songSource.stop(c.currentTime);
       }
    </script>


    </script>
  </body>
</html>
